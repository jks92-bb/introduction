---
description: ê°„ë‹¨í•œ ê²Œì„ì»¤ë®¤ë‹ˆí‹° ì‚¬ì´íŠ¸ë¥¼ ì œì‘í–ˆìŠµë‹ˆë‹¤.
---

# ê²Œì„ì»¤ë®¤ë‹ˆí‹°ì‚¬ì´íŠ¸

* /ğŸ—“ï¸í”„ë¡œì íŠ¸ ê¸°ê°„\[24.01.10\~24.02.16]

### í”„ë¡œì íŠ¸ ê°œìš”

<details>

<summary>ğŸ“Œê°œë°œ ëª©ì </summary>

ê²Œì„ì„ ì¦ê¸°ëŠ” ìœ ì €ë“¤ì˜ ì†Œí†µê³µê°„ì„ ë§Œë“¤ê³ ì í•˜ì˜€ìŠµë‹ˆë‹¤.

</details>

<details>

<summary>ğŸ› í™œìš© ë„êµ¬</summary>

<img src="https://img.shields.io/badge/java-007396?style=for-the-badge&#x26;logo=java&#x26;logoColor=white" alt="" data-size="original"><img src="https://img.shields.io/badge/html5-E34F26?style=for-the-badge&#x26;logo=html5&#x26;logoColor=white" alt="" data-size="original"><img src="https://img.shields.io/badge/css-1572B6?style=for-the-badge&#x26;logo=css3&#x26;logoColor=white" alt="" data-size="original"><img src="https://img.shields.io/badge/javascript-F7DF1E?style=for-the-badge&#x26;logo=javascript&#x26;logoColor=black" alt="" data-size="original"><img src="https://img.shields.io/badge/jquery-0769AD?style=for-the-badge&#x26;logo=jquery&#x26;logoColor=white" alt="" data-size="original"><img src="https://img.shields.io/badge/mysql-4479A1?style=for-the-badge&#x26;logo=mysql&#x26;logoColor=white" alt="" data-size="original"><img src="https://img.shields.io/badge/eclipseide-2C2255?style=for-the-badge&#x26;logo=eclipseide&#x26;logoColor=white" alt="" data-size="original"><img src="https://img.shields.io/badge/bootstrap-7952B3?style=for-the-badge&#x26;logo=bootstrap&#x26;logoColor=white" alt="" data-size="original"><img src="https://img.shields.io/badge/apachetomcat-F8DC75?style=for-the-badge&#x26;logo=apachetomcat&#x26;logoColor=white" alt="" data-size="original"><img src="https://img.shields.io/badge/github-181717?style=for-the-badge&#x26;logo=github&#x26;logoColor=white" alt="" data-size="original">

</details>

<details>

<summary>âš™ï¸êµ¬ì„±</summary>

JSON, JSTL.MYSQLì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë°›ì•„ì˜µë‹ˆë‹¤.

<img src="../../../.gitbook/assets/lib.PNG" alt="" data-size="original">

ê° ë¼ì´ë¸ŒëŸ¬ë¦¬ì— ëŒ€í•œ ì„¤ëª…ì…ë‹ˆë‹¤.

**1.json-simple.jar:** `json-simple`ì€ JSON ë°ì´í„°ë¥¼ ë‹¤ë£¨ê¸° ìœ„í•œ Java ë¼ì´ë¸ŒëŸ¬ë¦¬ì…ë‹ˆë‹¤. JSONì€ JavaScript Object Notationì˜ ì•½ì–´ë¡œ, ë°ì´í„°ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ êµí™˜í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ê²½ëŸ‰ì˜ ë°ì´í„° êµí™˜ í˜•ì‹ì…ë‹ˆë‹¤. `json-simple.jar`ëŠ” JSON ë°ì´í„°ë¥¼ ìƒì„±í•˜ê³  íŒŒì‹±í•˜ëŠ” ë° ë„ì›€ì´ ë˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ì…ë‹ˆë‹¤.

**2.jstl.jar (JavaServer Pages Standard Tag Library):** JSTLì€ JavaServer Pages (JSP)ì—ì„œ ì‚¬ìš©ë˜ëŠ” í‘œì¤€ íƒœê·¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ì…ë‹ˆë‹¤. JSTLì€ JSP í˜ì´ì§€ì—ì„œ ìì£¼ ì‚¬ìš©ë˜ëŠ” ì¼ë°˜ì ì¸ ì‘ì—…ë“¤ì„ ê°„í¸í•˜ê²Œ ì²˜ë¦¬í•˜ê¸° ìœ„í•œ íƒœê·¸ë“¤ì„ ì œê³µí•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ë£¨í”„, ì¡°ê±´ë¬¸, ë°ì´í„° í¬ë§¤íŒ… ë“±ì„ ì²˜ë¦¬í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. `jstl.jar` íŒŒì¼ì€ ì´ëŸ¬í•œ JSTL íƒœê·¸ë“¤ì„ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤.

**3.mysql-connector.jar:** `mysql-connector`ëŠ” MySQL ë°ì´í„°ë² ì´ìŠ¤ì™€ Java ì–´í”Œë¦¬ì¼€ì´ì…˜ ê°„ì˜ ì—°ê²°ì„ ì§€ì›í•˜ê¸° ìœ„í•œ JDBC(Java Database Connectivity) ë“œë¼ì´ë²„ì…ë‹ˆë‹¤. Java ì–´í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ MySQL ë°ì´í„°ë² ì´ìŠ¤ì— ì ‘ê·¼í•˜ê³  ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. `mysql-connector.jar` íŒŒì¼ì€ ì´ ë“œë¼ì´ë²„ë¥¼ í¬í•¨í•˜ê³  ìˆì–´ì„œ Java ì–´í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ MySQLê³¼ ìƒí˜¸ ì‘ìš©í•  ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤.

***

Controller, Command, PostCommand, DTO, DAOì™€ ì—¬ëŸ¬ html,jspíŒŒì¼ë¡œ ì´ë£¨ì–´ì ¸ ìˆìŠµë‹ˆë‹¤.

<img src="../../../.gitbook/assets/íŒ¨í„´ (1).PNG" alt="" data-size="original">

***

</details>

<details>

<summary>ğŸ“ƒì¤‘ì  ì½”ë“œ</summary>

#### server.xml

ì•„ë˜ì˜ ì½”ë“œëŠ” í†°ìº£ server.xml íŒŒì¼ì—ì„œ Resource ìš”ì†Œë¥¼ ì§€ì •í•´ì¤˜ì•¼ í•œë‹¤. ì§€ì •í•´ì£¼ëŠ” ì´ìœ ëŠ” ë°ì´í„°ë² ì´ìŠ¤ì™€ ì—°ë™í•˜ê¸° ìœ„í•¨ì´ë‹¤. passwordëŠ” ì œê±°í•˜ì—¬ ì˜¬ë ¸ìŠµë‹ˆë‹¤.

```xml
<Context docBase="gamecoummunity" path="/gamecommunity"  reloadable="true" source="org.eclipse.jst.jee.server:gamecoummunity">
			<Resource auth="Container" driverClassName="com.mysql.jdbc.Driver" name="jdbc/mysql" password="" type="javax.sql.DataSource" url="jdbc:mysql://localhost:3306/apidb" username="root"/>
			</Context>
			</Host>
		</Engine>
	</Service>
</Server>
```

#### ChatEndpoint.java

ì•„ë˜ì˜ ì½”ë“œëŠ” WebSocketë¥¼ ì‚¬ìš©í•˜ì—¬ ê°„ë‹¨í•œ ì±„íŒ…ì„ êµ¬í˜„í•˜ì˜€ìŠµë‹ˆë‹¤. ê°ê° ë‹¤ë¥¸ í´ë¼ì´ì–¸íŠ¸ ê°„ì— ì‹¤ì‹œê°„ ì±„íŒ…ì„ ê°€ëŠ¥ì¼€ í•˜ì˜€ìŠµë‹ˆë‹¤. í´ë¼ì´ì–¸íŠ¸ì—ì„œ WebSocketì„ í†µí•´ ì„œë²„ì— ì ‘ì†í•´ ë©”ì‹œì§€ë¥¼ ì£¼ê³ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```java
package com.project.Controller;

import java.io.IOException;
import java.util.Collections;
import java.util.HashSet;
import java.util.Set;

import javax.servlet.http.HttpSession;
import javax.websocket.EndpointConfig;
import javax.websocket.HandshakeResponse;
import javax.websocket.OnClose;
import javax.websocket.OnMessage;
import javax.websocket.OnOpen;
import javax.websocket.Session;
import javax.websocket.server.HandshakeRequest;
import javax.websocket.server.ServerEndpoint;
import javax.websocket.server.ServerEndpointConfig;

@ServerEndpoint(value = "/chat", configurator = ChatEndpoint.HttpSessionConfigurator.class)
public class ChatEndpoint {

    private static Set<Session> sessions = Collections.synchronizedSet(new HashSet<>());

    @OnOpen
    public void onOpen(Session session, EndpointConfig config) {
        HttpSession httpSession = (HttpSession) config.getUserProperties().get(HttpSession.class.getName());

        if (httpSession != null) {
            String userId = (String) httpSession.getAttribute("id");
            session.getUserProperties().put("userId", userId); 
            sessions.add(session);
            // ê³ ìœ ë²ˆí˜¸+ ì•„ì´ë”” 
            //broadcast("User connected: " + userId + " (Session ID: " + userId + ")");
            // ì•„ì´ë””
            broadcast("User connected: " + userId);
        } else {
            System.out.println("HttpSession is null");
        }
    }

    @OnClose
//    public void onClose(Session session) {
//        sessions.remove(session);
//        broadcast("User disconnected: (Session ID: " + session.getId() + ")");
//    }
    public void onClose(Session session) {
        String userId = (String) session.getUserProperties().get("userId");
        sessions.remove(session);
        broadcast("User disconnected: " + userId);
    }

    @OnMessage
//    public void onMessage(String message, Session session) {
//        broadcast("[" + session.getId() + "] " + message);
//    }
    public void onMessage(String message, Session session) {
        String userId = (String) session.getUserProperties().get("userId");
        broadcast("[" + userId + "] " + message);
    }
//    public void onMessage(String message, String userId)
//    {
//       broadcast("[" + userId + "] " + message);
//    }

 // ì´ ë©”ì„œë“œëŠ” WebSocket ì„¸ì…˜ ëª©ë¡ì— ìˆëŠ” ëª¨ë“  ì„¸ì…˜ì—ê²Œ ë©”ì‹œì§€ë¥¼ ë¸Œë¡œë“œìºìŠ¤íŠ¸í•©ë‹ˆë‹¤.
    private void broadcast(String message) {
        // ì„¸ì…˜ ëª©ë¡ì„ ìˆœíšŒí•˜ë©° ê° ì„¸ì…˜ì— ë©”ì‹œì§€ë¥¼ ë³´ëƒ…ë‹ˆë‹¤.
        for (Session session : sessions) {
            try {
            	 //String userId = (String) session.getUserProperties().get("userId");
            	// í•´ë‹¹ ì„¸ì…˜ì—ê²Œ í…ìŠ¤íŠ¸ ë©”ì‹œì§€ë¥¼ ë³´ëƒ…ë‹ˆë‹¤.
                 session.getBasicRemote().sendText(message);
                
               // session.getBasicRemote().sendText(message);
            } catch (IOException e) {
                // ë©”ì‹œì§€ ì „ì†¡ ì¤‘ì— IOExceptionì´ ë°œìƒí•˜ë©´ ì˜ˆì™¸ë¥¼ ì²˜ë¦¬í•˜ê³  ì½˜ì†”ì— ì¶œë ¥í•©ë‹ˆë‹¤.
                e.printStackTrace();
            }
        }
    }


    // HttpSessionConfigurator class
    public static class HttpSessionConfigurator extends ServerEndpointConfig.Configurator {
        @Override
        public void modifyHandshake(ServerEndpointConfig sec, HandshakeRequest request, HandshakeResponse response) {
            // HttpSessionì„ ê°€ì ¸ì™€ì„œ configì— ì €ì¥
            HttpSession httpSession = (HttpSession) request.getHttpSession();
            sec.getUserProperties().put(HttpSession.class.getName(), httpSession);
        }
    }
}

```

ì•„ë˜ëŠ” ë©”ì„œë“œì— ëŒ€í•œ ì„¤ëª…ì…ë‹ˆë‹¤.

1. @ServerEndpoint(value = "/chat", onfigurator=ChatEndpoint.HttpSessionConfigurator.class)

WebSocket ì„œë²„ ì—”ë“œí¬ì¸íŠ¸ë¥¼ ì •ì˜í•©ë‹ˆë‹¤. "/chat" ê²½ë¡œë¡œ WebSocket ìš”ì²­ì„ ì²˜ë¦¬í•©ë‹ˆë‹¤. HttpSessionConfiguratorë¥¼ ì‚¬ìš©í•˜ì—¬ WebSocket ì„¸ì…˜ì— HttpSessionì„ ì—°ê²°í•©ë‹ˆë‹¤.&#x20;

onOpen(Session session, EndpointConfig config)

ìƒˆë¡œìš´ WebSocket ì„¸ì…˜ì´ ì—´ë¦´ ë•Œ í˜¸ì¶œë˜ëŠ” ë©”ì„œë“œì…ë‹ˆë‹¤. ì—°ê²°ëœ HttpSessionì—ì„œ ì‚¬ìš©ì ì•„ì´ë””ë¥¼ ê°€ì ¸ì™€ì„œ WebSocket ì„¸ì…˜ì˜ ì‚¬ìš©ì ì†ì„±ì— ì €ì¥í•©ë‹ˆë‹¤. ì„¸ì…˜ì„ ì„¸ì…˜ ëª©ë¡ì— ì¶”ê°€í•˜ê³ , ì‚¬ìš©ìê°€ ì±„íŒ…ì— ì°¸ì—¬í–ˆë‹¤ëŠ” ë©”ì‹œì§€ë¥¼ ë¸Œë¡œë“œìºìŠ¤íŠ¸í•©ë‹ˆë‹¤.

2. &#x20;onClose(Session session)

WebSocket ì„¸ì…˜ì´ ë‹«í ë•Œ í˜¸ì¶œë˜ëŠ” ë©”ì„œë“œì…ë‹ˆë‹¤. ì„¸ì…˜ ëª©ë¡ì—ì„œ ì„¸ì…˜ì„ ì œê±°í•˜ê³ , ì‚¬ìš©ìê°€ ì±„íŒ…ì—ì„œ ë‚˜ê°”ë‹¤ëŠ” ë©”ì‹œì§€ë¥¼ ë¸Œë¡œë“œìºìŠ¤íŠ¸í•©ë‹ˆë‹¤.&#x20;

3. onMessage(String message, Session session)

í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„° ë©”ì‹œì§€ê°€ ë„ì°©í–ˆì„ ë•Œ í˜¸ì¶œë˜ëŠ” ë©”ì„œë“œì…ë‹ˆë‹¤. í•´ë‹¹ ì„¸ì…˜ì— ì—°ê²°ëœ ì‚¬ìš©ì ì•„ì´ë””ë¥¼ ê°€ì ¸ì™€ì„œ ë©”ì‹œì§€ë¥¼ ì¡°í•©í•˜ê³ , ëª¨ë“  ì„¸ì…˜ì—ê²Œ í•´ë‹¹ ë©”ì‹œì§€ë¥¼ ë¸Œë¡œë“œìºìŠ¤íŠ¸í•©ë‹ˆë‹¤.

4. broadcast(String message)

ì„¸ì…˜ ëª©ë¡ì— ìˆëŠ” ëª¨ë“  ì„¸ì…˜ì—ê²Œ ë©”ì‹œì§€ë¥¼ ë¸Œë¡œë“œìºìŠ¤íŠ¸í•˜ëŠ” ë©”ì„œë“œì…ë‹ˆë‹¤. HttpSessionConfigurator

WebSocket ì„¸ì…˜ì— HttpSessionì„ ì—°ê²°í•˜ê¸° ìœ„í•œ êµ¬ì„± í´ë˜ìŠ¤ì…ë‹ˆë‹¤. modifyHandshake ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ HttpSessionì„ ê°€ì ¸ì™€ WebSocket ì„¸ì…˜ êµ¬ì„±ì— ì¶”ê°€í•©ë‹ˆë‹¤.

***

#### mainboard.jsp
ë©”ì¸í™”ë©´ì—ì„œ ì‚¬ìš©í•œ ì±„íŒ…ì°½ ì½”ë“œì…ë‹ˆë‹¤.

```html
  ëŒ€í™”ì°½
             <div id="chat"></div>
    <input type="text" id="messageInput" onkeydown="handleKeyPress(event)" />
    <button onclick="sendMessage()"> Send</button>
    <script>
        const ws = new WebSocket("ws://localhost:8182/webTeamPJ/chat");

        ws.onopen = function(event) {
            appendMessage("ëŒ€í™”ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”");
        };

        ws.onmessage = function(event) {
            const message = event.data;
            appendMessage(message);
            //const userId = session.getAttribute("id");
            //appendMessage("[" + userId + "] " + message);
            
        };

        ws.onclose = function(event) {
            appendMessage("WebSocket connection closed");
        };

        // ë©”ì‹œì§€ ì „ì†¡
        function sendMessage() {
            const messageInput = document.getElementById("messageInput");
            const message = messageInput.value;

            ws.send(message);
            messageInput.value = "";
        }

        //ë©”ì‹œì§€ ì¶œë ¥
        function appendMessage(message) {
            const chatDiv = document.getElementById("chat");
            const messageDiv = document.createElement("div");
            messageDiv.textContent = message;
            chatDiv.appendChild(messageDiv);
            
            chatDiv.scrollTop = chatDiv.scrollHeight;
        }
        
        // ì—”í„° í‚¤ í•¸ë“¤ë§
        function handleKeyPress(event) {
            if (event.key === "Enter") {
                sendMessage();
                event.preventDefault(); // ì—”í„° í‚¤ì˜ ê¸°ë³¸ ë™ì‘(ìƒˆ ì¤„ ì¶”ê°€)ì„ ë§‰ìŠµë‹ˆë‹¤.
            }
        }
    </script>

```

#### PostDAO.java

ê²Œì‹œë¬¼ ê´€ë ¨ DAO ì½”ë“œì…ë‹ˆë‹¤. [ì‘ì„±,ëª©ë¡ë³´ê¸°, ìƒì„¸ë³´ê¸°,ê²€ìƒ‰,ìˆ˜ì •,ì‚­ì œ]
```java
package com.project.DAO;

import java.io.PrintWriter;
import java.sql.*;
import java.util.*;

import javax.naming.Context;
import javax.naming.InitialContext;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;
import javax.sql.*;

import com.project.DTO.PostDTO;

public class PostDAO {
	private Connection conn = null;
	private PreparedStatement ps = null;
	private ResultSet rs = null;
	private DataSource ds = null;
	private Statement st = null;

	public PostDAO() {
		try {
			// JNDIë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„° ì†ŒìŠ¤ ì„¤ì •
			Context ctx = new InitialContext();
			ds = (DataSource) ctx.lookup("java:comp/env/jdbc/mysql");
		} catch (Exception e) {
			System.out.println("PostDAO ìƒì„±ì ì—ëŸ¬");
			e.printStackTrace();
		}
	}

	public void Move(HttpServletRequest request, HttpServletResponse response) {
		HttpSession session = request.getSession(); // ê¸°ì¡´ ì„¸ì…˜ ê°€ì ¸ì˜¤ê¸°
		session.setAttribute("newBoardList", null);
		session.setAttribute("BoardList", null);

	}

	// ê²Œì‹œë¬¼ ì‘ì„±
	public void PostInsert(String tag, String ID, String TITLE, String CONTENT, String FILE, String useridx, HttpServletRequest request,
			HttpServletResponse response) {
		try {
			// ë¹„ì–´ ìˆëŠ” í•­ëª©ì„ ê¸°ë¡í•  ë³€ìˆ˜ ì´ˆê¸°í™”
			List<String> emptyFields = new ArrayList<>();
			
			// ê° í•­ëª©ì´ ë¹„ì–´ìˆëŠ”ì§€ ì²´í¬
			if (tag == null || tag.trim().isEmpty()) {
				emptyFields.add("íƒœê·¸");
			}
			if (TITLE == null || TITLE.trim().isEmpty()) {
				emptyFields.add("ì œëª©");
			}
			if (CONTENT == null || CONTENT.trim().isEmpty()) {
				emptyFields.add("ë‚´ìš©");
			}

			// ì–´ë–¤ í•­ëª©ì´ ë¹„ì–´ ìˆìœ¼ë©´ ì‹¤íŒ¨ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ ë° JavaScript ê²½ê³ ì°½
			if (!emptyFields.isEmpty()) {
				
				String errorMessage = String.join(", ", emptyFields) + " (ì„)ë¥¼ ì‘ì„± í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.";

				// JavaScript ì½”ë“œë¥¼ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì „ë‹¬í•˜ê¸° ìœ„í•œ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±
				String jsScript = "alert('" + errorMessage + "'); location.href = 'newPost.jsp';";

				// JavaScript ì½”ë“œë¥¼ ì‘ë‹µì— í¬í•¨í•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì „ì†¡
				response.setContentType("text/html;charset=UTF-8");
				PrintWriter out = response.getWriter();
				out.println("<script>" + jsScript + "</script>");
				out.close();
			} else {
				// DB ì—°ê²°
				conn = ds.getConnection();

				// INSERT ì¿¼ë¦¬ ìˆ˜í–‰
				String query = "INSERT INTO board (tag, ID, TITLE, CONTENT, DATE, FILE, isgood, useridx) VALUES (?, ?, ?, ?, now(), ?, 0, ?)";
				ps = conn.prepareStatement(query);
				ps.setString(1, tag);
				ps.setString(2, ID);
				ps.setString(3, TITLE);
				ps.setString(4, CONTENT);
				ps.setString(5, FILE);
				ps.setString(6, useridx);
				

				try {
					ps.executeUpdate();
					System.out.println("ê²Œì‹œë¬¼ ì‘ì„± ì™„ë£Œ.");
					System.out.println("íƒœê·¸ : " + tag);
					System.out.println("ì‘ì„±ì ì•„ì´ë”” : " + ID);
					System.out.println("ê¸€ ì œëª© : " + TITLE);
					System.out.println("ê¸€ ë‚´ìš© : " + CONTENT);
					response.sendRedirect("succcessPosting.jsp");
				} catch (Exception e) {
					System.out.println("ê²Œì‹œë¬¼ ì‘ì„± ì‹¤íŒ¨ (catch).");
					String errorMessage2 = "ë¡œê·¸ì¸ í›„ ì‘ì„±í•´ì£¼ì„¸ìš”.";
					String jsScript2 = "alert('" + errorMessage2 + "'); location.href = 'login.html';";
					response.setContentType("text/html;charset=UTF-8");
					PrintWriter out2 = response.getWriter();
					out2.println("<script>" + jsScript2 + "</script>");
					out2.close();
					// response.sendRedirect("login.html");
				}
			}
		} catch (Exception e) {
			System.out.println("Insert ì¿¼ë¦¬ ìˆ˜í–‰ ì‹¤íŒ¨");
			e.printStackTrace();
		}
	}

	// ê²Œì‹œë¬¼ ëª©ë¡
	public void PostList(HttpServletRequest request, HttpServletResponse response) {

		conn = null;
		st = null;
		rs = null;

		HttpSession session = request.getSession(true);
		session.setAttribute("boardList", null);
		try {
			conn = ds.getConnection();
			String Query = "select * from board order by IDX desc";
			ps = conn.prepareStatement(Query);
			rs = ps.executeQuery();
			List<Map<String, String>> boardList = new ArrayList<>();
			while (rs.next()) {
				Map<String, String> boardInfo = new HashMap<>();
				boardInfo.put("tag", rs.getString("tag"));
				boardInfo.put("title", rs.getString("TITLE"));
				boardInfo.put("idx", rs.getString("IDX"));

				boardList.add(boardInfo);
			}

			session.setAttribute("boardList", boardList);

			response.sendRedirect("ViewPost.jsp");
		} catch (Exception e) {
			System.out.println(e.toString());
			e.printStackTrace();
		} finally {
			try {
				if (rs != null) {
					rs.close();
				}
				if (st != null) {
					st.close();
				}
				if (conn != null) {
					conn.close();
				}
			} catch (Exception e2) {
				System.out.println(e2.toString());
				e2.printStackTrace();
			}
		}
	}

	// ê²Œì‹œë¬¼ ìƒì„¸ ë³´ê¸°
	   public void detailPost(String IDX, HttpServletRequest request, HttpServletResponse response) {

	      conn = null;
	      st = null;
	      rs = null;

	      HttpSession session = request.getSession(true);

	      try {
	         conn = ds.getConnection();
	         String Query = "select * from board where IDX=?";
	         ps = conn.prepareStatement(Query);
	         ps.setString(1, IDX);
	         rs = ps.executeQuery();

	         if (rs.next()) {
	            List<Map<String, String>> DVPost = new ArrayList<>();
	            Map<String, String> detailPostMap = new HashMap<>();
	            detailPostMap.put("DPIdx", rs.getString("IDX"));
	            detailPostMap.put("DPTitle", rs.getString("TITLE"));
	            detailPostMap.put("DPContent", rs.getString("CONTENT"));
	            detailPostMap.put("DPId", rs.getString("ID"));
	            detailPostMap.put("DPDate", rs.getString("DATE"));
	            detailPostMap.put("DPTag", rs.getString("tag"));
	            detailPostMap.put("DPIsgood", rs.getString("isgood"));
	            detailPostMap.put("DPuseridx", rs.getString("useridx"));
	            System.out.println(session.getAttribute("useridx"));
	            DVPost.add(detailPostMap);
	            session.setAttribute("DPIdx", request.getParameter("DPIdx"));
	            session.setAttribute("DVPost", DVPost);
	            response.sendRedirect("detailPost.jsp");
	         }
	      } catch (Exception e) {
	         System.out.println(e.toString());
	         e.printStackTrace();
	      } finally {
	         try {
	            if (rs != null) {
	               rs.close();
	            }
	            if (ps != null) {
	               ps.close();
	            }
	            if (conn != null) {
	               conn.close();
	            }
	         } catch (Exception e2) {
	            System.out.println(e2.toString());
	            e2.printStackTrace();
	         }
	      }
	   }

	// ê²Œì‹œíŒ ê²€ìƒ‰
	public List<PostDTO> searchPosts(String keyword) {
		List<PostDTO> result = new ArrayList<>();
		conn = null;
		ps = null;
		rs = null;

		try {

			// connection ê°ì²´ ìƒì„±
			conn = ds.getConnection();

			// ê²Œì‹œê¸€ì—ì„œ ì œëª© ë˜ëŠ” ë‚´ìš©ì— í‚¤ì›Œë“œê°€ í¬í•¨ëœ ê²ƒì„ ê²€ìƒ‰í•˜ë©°, ê²°ê³¼ë¥¼ IDX ê¸°ì¤€ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœìœ¼ë¡œ ì •ë ¬
			String query = "SELECT * FROM board WHERE title LIKE ? OR content LIKE ? ORDER BY IDX DESC";
			ps = conn.prepareStatement(query);
			ps.setString(1, "%" + keyword + "%");
			ps.setString(2, "%" + keyword + "%");
			rs = ps.executeQuery();
			while (rs.next()) {
				// ê²°ê³¼ë¥¼ PostDTO ê°ì²´ë¡œ ë§¤í•‘í•˜ì—¬ ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€
				PostDTO post = new PostDTO();

				post.setIDX(String.valueOf(rs.getInt("IDX")));
				post.setTag(rs.getString("tag"));
				post.setTITLE(rs.getString("TITLE"));
				post.setId(rs.getString("ID"));
				post.setCONTENT(rs.getString("CONTENT"));
				post.setDATE(rs.getString("DATE"));

				result.add(post);
			}
		} catch (Exception e) {
			System.out.println("ê²Œì‹œíŒ ê²€ìƒ‰ ì‹¤íŒ¨");
			e.printStackTrace();
		} finally {
			try {
				if (rs != null)
					rs.close();
				if (ps != null)
					ps.close();
				if (conn != null)
					conn.close();
				System.out.println("POSTDAO finally í†µê³¼");
			} catch (Exception e2) {
				System.out.println("ê°ì²´ ë‹«ê¸° ì‹¤íŒ¨");
				e2.printStackTrace();
			}
		}
		System.out.println("ì¢‹ì•˜ì–´postDAO ë°˜í™˜ ì „");
		System.out.println(result);
		return result;
	}

	public void PostMove(HttpServletRequest request, HttpServletResponse response) {

		conn = null;
		st = null;
		rs = null;

		HttpSession session = request.getSession(true);
		session.setAttribute("newBoardList", null);
		try {
			conn = ds.getConnection();
			String Query = "select * from board order by DATE desc";
			ps = conn.prepareStatement(Query);
			rs = ps.executeQuery();
			List<Map<String, String>> boardList = new ArrayList<>();
			while (rs.next()) {
				Map<String, String> boardInfo = new HashMap<>();
				boardInfo.put("tag", rs.getString("tag"));
				boardInfo.put("title", rs.getString("title"));
				boardInfo.put("idx", rs.getString("idx"));
				boardInfo.put("id", rs.getString("id"));
				boardInfo.put("date", rs.getString("date"));
				boardInfo.put("isgood", rs.getString("isgood"));

				boardList.add(boardInfo);
			}

			session.setAttribute("newBoardList", boardList);
		} catch (Exception e) {
			System.out.println(e.toString());
			e.printStackTrace();
		} finally {
			try {
				if (rs != null) {
					rs.close();
				}
				if (st != null) {
					st.close();
				}
				if (conn != null) {
					conn.close();
				}
			} catch (Exception e2) {
				System.out.println(e2.toString());
				e2.printStackTrace();
			}
		}
	}
	
	// ê²Œì‹œë¬¼ ìˆ˜ì •
	   public void PostUpdate(String tag, String ID, String TITLE, String CONTENT, String FILE, String IDX,
	         HttpServletRequest request, HttpServletResponse response) {
	      try {
	         // ë¹„ì–´ ìˆëŠ” í•­ëª©ì„ ê¸°ë¡í•  ë³€ìˆ˜ ì´ˆê¸°í™”
	         List<String> emptyFields = new ArrayList<>();

	         // ê° í•­ëª©ì´ ë¹„ì–´ìˆëŠ”ì§€ ì²´í¬
	         if (tag == null || tag.trim().isEmpty()) {
	            emptyFields.add("íƒœê·¸");
	         }
	         if (TITLE == null || TITLE.trim().isEmpty()) {
	            emptyFields.add("ì œëª©");
	         }
	         if (CONTENT == null || CONTENT.trim().isEmpty()) {
	            emptyFields.add("ë‚´ìš©");
	         }

	         // ì–´ë–¤ í•­ëª©ì´ ë¹„ì–´ ìˆìœ¼ë©´ ì‹¤íŒ¨ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ ë° JavaScript ê²½ê³ ì°½
	         if (!emptyFields.isEmpty()) {
	            String errorMessage = String.join(", ", emptyFields) + " (ì„)ë¥¼ ì‘ì„± í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.";

	            // JavaScript ì½”ë“œë¥¼ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì „ë‹¬í•˜ê¸° ìœ„í•œ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±
	            String jsScript = "alert('" + errorMessage + "'); location.href = 'login.html';";

	            // JavaScript ì½”ë“œë¥¼ ì‘ë‹µì— í¬í•¨í•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì „ì†¡
	            response.setContentType("text/html;charset=UTF-8");
	            PrintWriter out = response.getWriter();
	            out.println("<script>" + jsScript + "</script>");
	            out.close();
	         } else {
	            // DB ì—°ê²°
	            conn = ds.getConnection();

	            // INSERT ì¿¼ë¦¬ ìˆ˜í–‰
	            String query = "UPDATE board SET tag = ?, TITLE = ?, CONTENT = ?, DATE = now(), FILE = ? WHERE IDX = ?";
	            ps = conn.prepareStatement(query);
	            ps.setString(1, tag);
	            ps.setString(2, TITLE);
	            ps.setString(3, CONTENT);
	            ps.setString(4, FILE);
	            ps.setString(5, IDX);

	            try {
	               ps.executeUpdate();
	               System.out.println("ê²Œì‹œë¬¼ ìˆ˜ì • ì™„ë£Œ.");
	               System.out.println("íƒœê·¸ : " + tag);
	               System.out.println("ì‘ì„±ì ì•„ì´ë”” : " + ID);
	               System.out.println("ê¸€ ì œëª© : " + TITLE);
	               System.out.println("ê¸€ ë‚´ìš© : " + CONTENT);
	               response.sendRedirect("succcessPosting.jsp");
	            } catch (Exception e) {
	               System.out.println("ê²Œì‹œë¬¼ ìˆ˜ì • ì‹¤íŒ¨ (catch).");
	               String errorMessage2 = "ë¡œê·¸ì¸ í›„ ì‘ì„±í•´ì£¼ì„¸ìš”.";
	               String jsScript2 = "alert('" + errorMessage2 + "'); location.href = 'updatePost.jsp';";
	               response.setContentType("text/html;charset=UTF-8");
	               PrintWriter out2 = response.getWriter();
	               out2.println("<script>" + jsScript2 + "</script>");
	               out2.close();
	               // response.sendRedirect("login.html");
	            }
	         }
	      } catch (Exception e) {
	         System.out.println("update ì¿¼ë¦¬ ìˆ˜í–‰ ì‹¤íŒ¨");
	         e.printStackTrace();
	      }
	   }

	   // ê²Œì‹œë¬¼ ì‚­ì œ
	   public void PostDelete(String IDX, HttpServletRequest request, HttpServletResponse response) {
	      conn = null;
	      ps = null;
	      rs = null;      
	      try {
	               // DB ì—°ê²°
	               conn = ds.getConnection();

	               // INSERT ì¿¼ë¦¬ ìˆ˜í–‰
	               String query = "delete from board WHERE IDX = ?";
	               ps = conn.prepareStatement(query);
	               ps.setString(1, IDX);
	               ps.executeUpdate();
	               response.sendRedirect("main.doPosting");
	      } catch (Exception e) {
	         System.out.println("Delete ì¿¼ë¦¬ ìˆ˜í–‰ ì‹¤íŒ¨");
	         e.printStackTrace();
	      }
	   }
	}



```

#### PostServiceinsert.java
í¬ìŠ¤íŠ¸ ì…ë ¥ì‹œ í•„ìš”í•œ command ì½”ë“œì…ë‹ˆë‹¤.

```java
package com.project.PostCommand;

import java.io.ByteArrayOutputStream;
import java.io.InputStream;
import java.util.ArrayList;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;
import javax.servlet.http.Part;

import com.project.DAO.PostDAO;
import com.project.DAO.UserDAO;
import com.project.DTO.PostDTO;
import com.project.DTO.UserDTO;

public class PostServiceInsert implements PostService {
    public ArrayList<PostDTO> execute(HttpServletRequest request, HttpServletResponse response) {
        ArrayList<PostDTO> dtoList = null;
        
        HttpSession session = request.getSession();
        // DAOì— ìˆëŠ” insert ë©”ì†Œë“œ ìˆ˜í–‰
        PostDAO postDAO = new PostDAO();
        String tag = request.getParameter("tag");
        String nickname = (String)session.getAttribute("nickname");
        String TITLE = request.getParameter("TITLE");
        String CONTENT = request.getParameter("CONTENT");
        String USERIDX = (String)session.getAttribute("useridx");
        ByteArrayOutputStream buffer = new ByteArrayOutputStream();
        int nRead;
        byte[] data = new byte[1024];
        
        try {
           Part filePart = request.getPart("fileUpload");
           InputStream fileContent = filePart.getInputStream();
           
           while ((nRead = fileContent.read(data, 0, data.length)) != -1) {
                buffer.write(data, 0, nRead);
            }
           buffer.flush();
        }catch(Exception e) {
           e.printStackTrace();
        }
        
        byte[] fileBytes = buffer.toByteArray();
        
        // PostDAO í´ë˜ìŠ¤ì˜ PostInsert ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•˜ì—¬ ì‚¬ìš©ì ì •ë³´ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— ì‚½ì…
        postDAO.PostInsert(tag, nickname, TITLE, CONTENT, fileBytes, USERIDX,request, response);

        return dtoList;
    }
}

//long blobë¡œ í…Œì´ë¸”ì»¬ëŸ¼ ìˆ˜ì •í•´ ìµœëŒ€ 4ê¸°ê°€íŒŒì¼ê¹Œì§€ ì—…ë¡œë“œ ê°€ëŠ¥

```
#### PostCommandController.java
```java
package com.project.Controller;

import java.io.IOException;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import javax.servlet.RequestDispatcher;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;

import com.project.Command.UserService;
import com.project.Command.UserServiceDelete;
import com.project.Command.UserServiceFindID;
import com.project.Command.UserServiceFindPW;
import com.project.Command.UserServiceInsert;
import com.project.Command.UserServiceLogin;
import com.project.Command.UserServiceLogout;
import com.project.Command.UserServiceUpdate;
import com.project.DTO.PostDTO;
import com.project.PostCommand.DetailPost;
import com.project.PostCommand.PostService;
import com.project.PostCommand.PostServiceDelete;
import com.project.PostCommand.PostServiceInsert;
import com.project.PostCommand.PostServiceMove;
import com.project.PostCommand.ViewPost;
import com.project.PostCommand.PostServiceSearch;
import com.project.PostCommand.PostServiceupdate;

/**
 * Servlet implementation class PostCommandController
 */
@WebServlet("*.doPosting")
public class PostCommandController extends HttpServlet {
	private static final long serialVersionUID = 1L;

	/**
	 * @see HttpServlet#HttpServlet()
	 */
	public PostCommandController() {
		super();
		// TODO Auto-generated constructor stub
	}

	/**
	 * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse
	 *      response)
	 */
	protected void doGet(HttpServletRequest request, HttpServletResponse response)
			throws ServletException, IOException {
		doPostingAction(request, response);
	}

	/**
	 * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse
	 *      response)
	 */
	protected void doPost(HttpServletRequest request, HttpServletResponse response)
			throws ServletException, IOException {
		doPostingAction(request, response);
	}

	protected void doPostingAction(HttpServletRequest request, HttpServletResponse response)
			throws ServletException, IOException {
		request.setCharacterEncoding("UTF-8");
		String uri = request.getRequestURI();
		String conPath = request.getContextPath();
		String command = uri.substring(conPath.length());

		// View(jsp), Controller(í”„ë¡ íŠ¸ì»¨íŠ¸ë¡¤ëŸ¬, ì»¤ë©˜ë“œ)
		PostService pService = null;
		UserService uService = null;
		HttpSession session = request.getSession(false);

		if (command.equals("/insert.doPosting")) {

			System.out.println("<ê²Œì‹œë¬¼ ì‘ì„±>(ì„)ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤.");
			try {
				pService = new PostServiceInsert();
			} catch (Exception e) {
				e.printStackTrace();
			}
		} else if (command.equals("/viewPL.doPosting")) {
			System.out.println("<ê²Œì‹œë¬¼ ë³´ê¸°>(ì„)ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤.");
			pService = new ViewPost();
		} else if (command.equals("/search.doPosting")) {
			System.out.println("<ê²Œì‹œíŒ ê²€ìƒ‰>ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.");
			pService = new PostServiceSearch();
			System.out.println("<ê²Œì‹œíŒ ê²€ìƒ‰>ì™„ë£Œ");

			// ì—¬ê¸°ì— ì¶”ê°€: ê²€ìƒ‰ ê²°ê³¼ë¥¼ ë°›ì•„ì˜¨ í›„, ê²°ê³¼ë¥¼ requestì— ì €ì¥
			ArrayList<PostDTO> searchResult = (ArrayList<PostDTO>) pService.execute(request, response);
			request.setAttribute("postList", searchResult);

			// ì—¬ê¸°ì— ì¶”ê°€: ê²€ìƒ‰ ê²°ê³¼ë¥¼ ë°›ì•„ì˜¨ í›„, getLIst.jspë¡œ í¬ì›Œë”©
			RequestDispatcher dispatcher = request.getRequestDispatcher("getList.jsp");
			dispatcher.forward(request, response);
		} else if (command.equals("/detail.doPosting")) {

			String selectIdx = request.getParameter("IDX");
			System.out.println(selectIdx);
			request.setAttribute("selectIdx", selectIdx);
			pService = new DetailPost();
		} else if (command.equals("/update.doPosting")) {
			pService = new PostServiceupdate();
		} else if (command.equals("/delete.doPosting")) {
			System.out.println("<ê²Œì‹œê¸€ ì‚­ì œ>ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤.");
			pService = new PostServiceDelete();
		} else if (command.equals("/FIFA.doPosting")) {
			System.out.println("<ê²Œì‹œíŒ ì´ë™>ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.");
			pService = new PostServiceMove();

			response.sendRedirect("FIFA.jsp");
		} else if (command.equals("/starcraft.doPosting")) {
			System.out.println("<ê²Œì‹œíŒ ì´ë™>ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.");
			pService = new PostServiceMove();

			response.sendRedirect("starcraft.jsp");
		} else if (command.equals("/LoL.doPosting")) {
			System.out.println("<ê²Œì‹œíŒ ì´ë™>ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.");
			pService = new PostServiceMove();

			response.sendRedirect("LoL.jsp");
		} else if (command.equals("/palworld.doPosting")) {
			System.out.println("<ê²Œì‹œíŒ ì´ë™>ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.");
			pService = new PostServiceMove();

			response.sendRedirect("palworld.jsp");
		} else if (command.equals("/maplestory.doPosting")) {
			System.out.println("<ê²Œì‹œíŒ ì´ë™>ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.");
			pService = new PostServiceMove();

			response.sendRedirect("maplestory.jsp");
		} else if (command.equals("/main.doPosting")) {
			System.out.println("<ê²Œì‹œíŒ ì´ë™>ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.");
			pService = new PostServiceMove();

			response.sendRedirect("mainboard.jsp");
		}
	
		
		
		pService.execute(request, response);
	}

}
```








</details>

<details>

<summary>ğŸ”í”„ë¡œì íŠ¸ git ì£¼ì†Œ</summary>

[https://github.com/db-ung/web\_pj](https://github.com/db-ung/web\_pj)

</details>
